# –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ4 –ø–æ –∫—É—Ä—Å—É "[Data Engineer —Å –Ω—É–ª—è –¥–æ junior](https://stepik.org/course/137235/syllabus)"

–ü—Ä–æ–µ–∫—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –∏–∑ –º–æ–∫ —Ñ–∞–π–ª–∞ _data_mock.json_ –≤ –ë–î Postgres.

–†–µ–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö:

- **total_revenue(purchases):** –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ –∏ –≤–µ—Ä–Ω–∏—Ç–µ –æ–±—â—É—é –≤—ã—Ä—É—á–∫—É (—Ü–µ–Ω–∞ * –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π).
- **items_by_category(purchases):** –í–µ—Ä–Ω–∏—Ç–µ —Å–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –∞ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî —Å–ø–∏—Å–æ–∫ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
- **expensive_purchases(purchases, min_price):** –í—ã–≤–µ–¥–∏—Ç–µ –≤—Å–µ –ø–æ–∫—É–ø–∫–∏, –≥–¥–µ —Ü–µ–Ω–∞ —Ç–æ–≤–∞—Ä–∞ –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–∞ min_price.
- **average_price_by_category(purchases):** –†–∞—Å—Å—á–∏—Ç–∞–π—Ç–µ —Å—Ä–µ–¥–Ω—é—é —Ü–µ–Ω—É —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
- **most_frequent_category(purchases):** –ù–∞–π–¥–∏—Ç–µ –∏ –≤–µ—Ä–Ω–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π –∫—É–ø–ª–µ–Ω–æ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–æ–≤ (—É—á–∏—Ç—ã–≤–∞–π—Ç–µ –ø–æ–ª–µ quantity).

## üõ† –°—Ç—ç–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- python 3.12
- - asyncpg
- - pydantic
- - sqlalchemy
- - alembic
- postgres
- docker
- - docker-compose

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

1. –°–∫–∞—á–∏–≤–∞–µ–º –ø—Ä–æ–µ–∫—Ç —Å –≥–∏—Ç–∞
```shell
git clone https://github.com/lexa946/control_work_-4.git
```
2. –°–æ–∑–¥–∞—Ç—å –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–∞–π–ª—ã **.env** –∏ **.env-postgres**
<details> 
    <summary>.env</summary>

    
    DB_USERNAME=<–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î>
    DB_PASSWORD=<–ü–∞—Ä–æ–ª—å –ë–î>
    DB_NAME=<–ò–º—è –ë–î>
    DB_HOST=<–•–æ—Å—Ç –ë–î>
    DB_PORT=<–ü–æ—Ä—Ç –ë–î>
    
</details>
<details> 
    <summary>.env-postgres</summary>

    
    POSTGRES_USER=<–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î>
    POSTGRES_PASSWORD=<–ü–∞—Ä–æ–ª—å –ë–î>
    POSTGRES_DB=<–ò–º—è –ë–î>
    
</details>

3. –ù—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å __docker__ –∏ __docker-compose__. –≠—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–∞–∫–∞—è —É –≤–∞—Å –û–°.
4. –ó–∞–ø—É—Å–∫–∞–µ–º __docker-compose__ 
```shell
docker-compose up -d
```
5. –î–æ–∂–∏–¥–∞–µ–º—Å—è –∑–∞–ø—É—Å–∫–∞.<br>–î–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–µ:<br>
![docker start](./img/docker-compose starts.png)
6. –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Ç—Ä–∞–±–æ—Ç–∫—É –ø—Ä–æ–µ–∫—Ç–∞
```shell
docker-compose logs analyzer
```
![analyze](./img/analyze.png)
7. –ó–∞–≤–µ—Ä—à–∞–µ–º —Ä–∞–±–æ—Ç—É –¥–æ–∫–µ—Ä–æ–≤:
```shell
docker-compose down
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
–¢–∞–∫ –∫–∞–∫ —ç—Ç–æ —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, —Ç–æ –≤ —Å–∞–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —è –∑–∞–≥—Ä—É–∑–∏–ª –∏ **.env** –∏ **.env-postgres**. 
–í —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–π –Ω–∞ —Å–∞–º–æ–º —Å–µ—Ä–≤–µ—Ä–µ. 

## –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î (–∫–æ—Ç–æ—Ä—É—é —è –≤ –∫–æ–º–ø–æ—É–∑ –¥–æ–±–∞–≤–∏–ª), –Ω–æ –∏ —Å –ª—é–±–æ–π –¥—Ä—É–≥–æ–π. 
–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤ .env —É–∫–∞–∑–∞—Ç—å –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î. –í —Ç–µ–æ—Ä–∏–∏, —Ç–æ–≥–¥–∞ –º–æ–∂–Ω–æ –≤–æ–æ–±—â–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–º–ø–æ—É–∑,
–∞ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä analyzer. –ù–æ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –µ–≥–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ —Å–±–∏–ª–¥–∏—Ç—å. 
